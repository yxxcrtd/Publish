<html>
<head>
<title>自定义列表标签 </title>
<meta http-equiv='Content-Type' content='text/html; charset=gb2312'>
<script language="javascript">
function objectTag() {
    var strJS,OrderType;
	switch(document.form1.OrderType.selectedIndex)
    {
      case 0: OrderType='1'; break;
      case 1: OrderType='2'; break;
      case 2: OrderType='3'; break;
      case 3: OrderType='4'; break;
      case 4: OrderType='5'; break;
	  case 5: OrderType='6'; break;
	}
	var UsePage,ShowAuthor;
	for (var i=0;i<document.form1.UsePage.length;i++){
	var PowerEasy = document.form1.UsePage[i];
	if (PowerEasy.checked==true)	   
		UsePage = PowerEasy.value
	}
	for (var i=0;i<document.form1.ShowAuthor.length;i++){
	var PowerEasy = document.form1.ShowAuthor[i];
	if (PowerEasy.checked==true)	   
		ShowAuthor = PowerEasy.value
	}
    strJS="【ArticleList(";
	strJS+=document.form1.iChannelID.value;
	strJS+=","+document.form1.arrClassID.value;
	strJS+=","+document.form1.IncludeChild.checked;
	strJS+=","+document.form1.iSpecialID.value;
	strJS+=","+document.form1.IsHot.checked;
	strJS+=","+document.form1.IsElite.checked;
	strJS+=","+document.form1.ArticleNum.value;
	strJS+=","+ShowAuthor;
	strJS+=","+document.form1.DateNum.value;
	strJS+=","+OrderType;
	strJS+=","+UsePage;
	strJS+=","+document.form1.TitleLen.value;	
	strJS+=","+document.form1.ContentLen.value;	
	strJS+=")】"+document.form1.ArticleContent.value;
	strJS+="【/ArticleList】";
	window.returnValue = strJS;
	window.close();
}
function insertLabel(strLabel)
{
  form1.ArticleContent.focus();
  var str = document.selection.createRange();
  str.text = strLabel
}
</script>
<link href='admin_style.css' rel='stylesheet' type='text/css'>
<base target="_self">
</head>
<body>
<form name="form1">
<table width='700' border='0' align='center' cellpadding='2' cellspacing='1' class='border'>  
    <tr class=title>
      <td align=middle colSpan=2 height=22><STRONG>来显示文章自定义列表标签 </STRONG></td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>频道ID：</STRONG></td>
      <td height=25><input type='text' name='iChannelID' value='1' size="8"></td>
    </tr>
    <tr class=tdbg>
      <td width="130" align=right height=25><STRONG>栏目ID数组：</STRONG></td>
      <td height=25><input type='text' name='arrClassID' value='1' size="8">&nbsp;&nbsp;0为所有栏目。调用多个
不同栏目ID以|分隔，如2|4|7|9|10</td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>是否包含子栏目：</STRONG></td>
      <td height=25>
        <Input  type=checkbox value=1 name=IncludeChild></td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>专题ID：</STRONG></td>
      <td height=25><input type='text' name='iSpecialID' value='1' size="8"></td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>文章数：</STRONG></td>
      <td height=25><input type='text' name='ArticleNum' value='0' size="8"></td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>文章属性：</STRONG></td>
      <td height=25>
        <Input id=IsHot type=checkbox value=1 name=IsHot> 热门文章&nbsp;&nbsp;&nbsp;&nbsp;
        <Input id=IsElite type=checkbox value=1 name=IsElite> 推荐文章&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#ff0000>如果都不选，将显示所有文章。</FONT></td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>是否显示文章作者：</STRONG></td>
      <td height=25>
	  <input type="radio" name="ShowAuthor" checked value="True">是
      <input type="radio" name="ShowAuthor" value="False">否</td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>日期范围：</STRONG></td>
      <td height=25>只显示最近 
        <Input id=DateNum maxLength=3 size=5 value=30 name=DateNum> 天内更新的文章&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#ff0000>&nbsp;&nbsp;如果为空或0，则显示所有天数的文章。</FONT></td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>排序方法：</STRONG></td>
      <td height=25>
		<Select id='OrderType' name='OrderType'> 
		  <Option value=1 selected>文章ID（降序）</Option> 
		  <Option value=2>文章ID（升序）</Option> 
		  <Option value=3>更新时间（降序）</Option> 
		  <Option value=4>更新时间（升序）</Option> 
		  <Option value=5>点击次数（降序）</Option> 
		  <Option value=6>点击次数（升序）</Option>
	    </Select>
	  </td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>是否分页显示：</STRONG></td>
      <td height=25>
	    <input type="radio" name="UsePage" checked value="True">是
        <input type="radio" name="UsePage" value="False">否</td> 
	</tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>文章标题最多字符：</STRONG></td>
      <td height=25>
        <Input  maxLength=3 size=5 value=0 name=TitleLen> &nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#ff0000>一个汉字=两个英文字符，为0时不显示</FONT></td>
    </tr>
	<tr class=tdbg>
      <td width="130" align=right height=25><STRONG>文章内容最多字符：</STRONG></td>
      <td height=25>
        <Input  maxLength=3 size=5 value=0 name=ContentLen> &nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#ff0000>一个汉字=两个英文字符，为0时不显示</FONT></td>
    </tr>
	<tr class=tdbg>
	  <td width="130" align=right height=25><STRONG>循环标签支持标签：</STRONG></td>
	  <td>
		<table border='0' cellpadding='0' cellspacing='0' width='100%' height='100%' align='center'>
		 <tr>
		   <td valign='top'><a href="javascript:insertLabel('#{ArticleUrl}')">#{ArticleUrl}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{ArticleID}')">#{ArticleID}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{UpdateTime}')">#{UpdateTime}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Stars}')">#{Stars}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Author}')">#{Author}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{CopyFrom}')">#{CopyFrom}</a></td>
		 </tr>
		 <tr>
		   <td valign='top'><a href="javascript:insertLabel('#{Hits}')">#{Hits}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Inputer}')">#{Inputer}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Editor}')">#{Editor}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{ReadPoint}')">#{ReadPoint}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Property}')">#{Property}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Top}')">#{Top}</a></td>
		 </tr>
		 <tr>
		   <td valign='top'><a href="javascript:insertLabel('#{Elite}')">#{Elite}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Hot}')">#{Hot}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Title}')">#{Title}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Subheading}')">#{Subheading}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Intro}')">#{Intro}</a></td>
		   <td valign='top'><a href="javascript:insertLabel('#{Content}')">#{Content}</a></td>
		  </tr>
		  <tr>
		   <td valign='top'><a href="javascript:insertLabel('#{ArticlePic(130,90)}')">#{ArticlePic(130,90)}</a></td>
		   <td valign='top'></td>
		   <td valign='top'></td>
		   <td valign='top'></td>
		   <td valign='top'></td>
		   <td valign='top'></td>
		  </tr>
		</table>
	</td>
    </tr>
	<tr class='tdbg'>
		<td width="130" align=right height=25><STRONG>请输入循环标签Html代码：</STRONG></td>
		<td ><TEXTAREA NAME='ArticleContent' ROWS='' COLS='' style='width:550px;height:200px'></TEXTAREA></td>
	</tr>
	<tr class='tdbg'>
		<td colspan=2 align='center'><input TYPE='button' value=' 确 定 ' onCLICK='objectTag()'> </td>
	</tr>
  </table>
</FORM>
</body>
</html>